\documentclass[letterpaper,final,12pt,reqno]{amsart}

\usepackage[total={6.3in,9.2in},top=1.1in,left=1.1in]{geometry}

\usepackage{times,bm,bbm,empheq,fancyvrb,graphicx,amsthm,amssymb}
\usepackage[dvipsnames]{xcolor}
\usepackage{longtable}
\usepackage{booktabs}

\usepackage[within=section]{newfloat}

\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing}

\usepackage[kw]{pseudo}
\pseudoset{left-margin=15mm,topsep=5mm,idfont=\texttt}

% hyperref should be the last package we load
\usepackage[pdftex,
colorlinks=true,
plainpages=false, % only if colorlinks=true
linkcolor=blue,   % ...
citecolor=Red,    % ...
urlcolor=black    % ...
]{hyperref}

\renewcommand{\baselinestretch}{1.05}

\allowdisplaybreaks[1]  % allow display breaks in align environments, if they avoid major underfulls

\newtheoremstyle{cstyle}% name
  {5pt}% space above
  {5pt}% space below
  {\itshape}% body font
  {}% indent amount
  {\itshape}% theorem head font
  {.}% punctuation after theorem head
  {.5em}% space after theorem head
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}% theorem head spec
\theoremstyle{cstyle}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}

\newtheoremstyle{dstyle}% name
  {5pt}% space above
  {5pt}% space below
  {}%{\itshape}% body font
  {}% indent amount
  {\itshape}% theorem head font
  {.}% punctuation after theorem head
  {.5em}% space after theorem head
  {\thmname{#1}\thmnumber{ #2}\thmnote{ (#3)}}% theorem head spec
\theoremstyle{dstyle}

\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}

% numbering
\numberwithin{equation}{section}
\numberwithin{figure}{section}
\numberwithin{table}{section}
\numberwithin{theorem}{section}

\newcommand{\eps}{\epsilon}
\newcommand{\RR}{\mathbb{R}}

\newcommand{\grad}{\nabla}
\newcommand{\Div}{\nabla\cdot}
\newcommand{\trace}{\operatorname{tr}}

\newcommand{\hbn}{\hat{\mathbf{n}}}

\newcommand{\bb}{\mathbf{b}}
\newcommand{\be}{\mathbf{e}}
\newcommand{\bbf}{\mathbf{f}}
\newcommand{\bg}{\mathbf{g}}
\newcommand{\bn}{\mathbf{n}}
\newcommand{\br}{\mathbf{r}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bw}{\mathbf{w}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\bF}{\mathbf{F}}
\newcommand{\bV}{\mathbf{V}}
\newcommand{\bX}{\mathbf{X}}
\newcommand{\bxi}{\bm{\xi}}
\newcommand{\bzero}{\bm{0}}

\newcommand{\cK}{\mathcal{K}}
\newcommand{\cV}{\mathcal{V}}

\newcommand{\rhoi}{\rho_{\text{i}}}

\newcommand{\ip}[2]{\left<#1,#2\right>}

\newcommand{\mR}{R^{\bm{\oplus}}}
\newcommand{\iR}{R^{\bullet}}

\newcommand{\nn}{{\text{n}}}
\newcommand{\pp}{{\text{p}}}
\newcommand{\qq}{{\text{q}}}
\newcommand{\rr}{{\text{r}}}

\newcommand{\supp}{\operatorname{supp}}

\DeclareFloatingEnvironment[name=Pseudocode]{pcode}


\begin{document}
\title[On MCD methods for nonlinear and nonlocal VIs]{On multilevel constraint decomposition methods \\ for nonlinear variational inequalities}

\author{Ed Bueler}

\date{\today}

\begin{abstract} FIXME
\end{abstract}

\maketitle

%\tableofcontents

\thispagestyle{empty}
%\bigskip

\section{Introduction} \label{sec:intro}

The goal of this paper is to generalize the constraint decomposition (CD) method of X.-C.~Tai \cite{Tai2003}.  We extend this solution method to nonlinear variational inequality (VI) problems for which it has not been previously considered, we address important finite element (FE) implementation details, and we demonstrate the resulting performance.

The convergence of the CD method for several types of decompositions was proven in \cite{Tai2003} in the case of coercive VIs which arise from minimization of a convex functional over a convex set.  In its multilevel form the CD method has been shown to have optimal complexity for elliptic, linear obstacle problems \cite[subsection 5.4]{Tai2003}; see also Theorem 4.6 and Algorithm 4.7 in \cite{GraeserKornhuber2009}.  However, especially for the classical obstacle problem, i.e.~for a Laplacian functional, certain other methods are known to improve performance relative to the multilevel CD method \cite{GraeserKornhuber2009}.  On the other hand, these improved multilevel methods either track the active set or modify the nodal basis functions, and in this sense they are discrete algorithms.  By contrast the CD methods apply at the level of the continuum problem (see below), so the method is more fundamental than the truncated monotone multigrid method \cite{GraeserKornhuber2009,Kornhuber1994}, for example, in that sense.

We extend the original algorithms and theory presented in \cite{Tai2003} in three particular directions:
\renewcommand{\labelenumi}{\emph{(\roman{enumi})}}
\begin{enumerate}
\item We do not assume that the continuum VI problem arises from optimization of a scalar objective, and, as shown by examples in Section \ref{sec:vi}, this represents the removal of a symmetry assumption in \cite{Tai2003}.  Nonetheless we can prove convergence at essentially the same rate (Section \ref{sec:convergence}). % HOPE
\item In the multilevel case we make the observation that, if implemented appropriately, V(0,1) ``up-slash'' cycles are intrinsically more efficient than the V(1,0) ``down-slash'' cycles (Section \ref{sec:multilevel}).  This observation seems to be new for multilevel CD methods; compare the comments on V(1,0) and V(1,1) cycles in \cite{GraeserKornhuber2009,Tai2003}.  This preference for up-smoothing is, apparently, special to CD methods and does not arise in corresponding unconstrained subspace decomposition \cite{Xu1992} approaches.
\item In the multilevel and nonlinear case, we make the algorithms more practical by addressing efficient storage of intermediate quantities.  In particular we show results from a full approximation storage (FAS; \cite{Brandt1977}) version of the multilevel CD algorithm.
\end{enumerate}

As an additional difference from the presentation in \cite{Tai2003}, but an essentially formal one, we observe that the iterates from CD methods are always admissible, and thus the residual functional need only be defined on the admissible subset.  Methods like CD, for which all iterates are admissible, have an advantage because they allow direct solutions of certain VI problems, such as the fluid-layer dynamics problems in \cite{Bueler2021conservation,JouvetBueler2012}, for which non-admissible methods such as semi-smooth methods \cite{BensonMunson2006} may require unnatural modifications of the residual form.

In one example we consider a case where the residual functional is nonlocal, that is, where it is not a partial differential operator at all.  Instead its values instead arise from the solution of Stokes problems for a layer of fluid on a substrate which forms the obstacle \cite{SayagWorster2013}, so the corresponding FE operator discretization is not sparse.  In this case we cannot prove coercivity but we can demonstrate near-optimal complexity in practice.  % HOPE


\section{Coercive variational inequalities and constraint decomposition} \label{sec:vi}

Suppose $\cV$ is a real, reflexive Banach space with norm $\|v\|$ for $v\in\cV$ and topological dual space $\cV'$.  Denote the dual pairing of $\phi \in \cV'$ and $v$ by $\ip{\phi}{v} = \phi(v)$.  Note that $\|\phi\|_{\cV'} = \sup_{\|v\|=1} |\ip{\phi}{v}|$ defines the norm on $\cV'$, which is also a Banach space.

Let $\cK \subset \cV$ be a nonempty closed and convex subset of $\cV$, the \emph{constraint set}; elements of $\cK$ are said to be \emph{admissible}.  For a continuous \emph{residual functional} $f:\cK \to \cV'$ and \emph{source} $g\in \cV'$ we consider the following \emph{variational inequality} (VI) for $u\in \cK$:
\begin{equation}
\ip{f(u)}{v-u} \ge g(v-u) \qquad \text{for all } v\in \cK. \label{eq:vi}
\end{equation}
Because $f$ is a general, nonlinear map the use of a right-hand source function is not strictly needed---by redefining $f$ we may take $g=0$---but its inclusion will be helpful in describing algorithms in Section \ref{sec:multilevel}.

Informally, if we conceptualize the dual pairing as an inner product, and if $g=0$, then \eqref{eq:vi} says that the angle between $f(u)$ and any arbitrary vector $v-u$ pointing from $u$ into $\cK$ is at most $90^\circ$, that is, $f(u)$ points directly into $\cK$ if $u$ solves \eqref{eq:vi}.  Furthermore, if $u$ is in the interior of $\cK$ then \eqref{eq:vi} implies $f(u)=g$; this VI generalizes the concept of a nonlinear system of equations $f(u)=g$ over $\cV$ to the constrained case where $\cK \subsetneq \cV$.

The following definitions are standard \cite{KinderlehrerStampacchia1980}.

\begin{definition} A map $f:\cK \to \cV'$ is \emph{monotone} if
\begin{equation}
\ip{f(u)-f(v)}{u-v} \ge 0 \qquad \text{for all } u,v \in \cK, \label{eq:monotone}
\end{equation}
\emph{strictly monotone} if equality in \eqref{eq:monotone} implies $u=v$, and \emph{coercive} if there exists $w \in \cK$ so that
\begin{equation}
\frac{\ip{f(u)-f(w)}{u-w}}{\|u-w\|} \to +\infty \qquad \text{as } \|u\|\to +\infty. \label{eq:coercive}
\end{equation}
\end{definition}

It is well-known that if $f:\cK \to \cV'$ is continuous, monotone, and coercive then VI \eqref{eq:vi} has a solution \cite[Corollary III.1.8]{KinderlehrerStampacchia1980}, and also that the solution is unique if $f$ is strictly monotone.  The condition of continuity can be weakened to only apply on finite-dimensional subspaces \cite{KinderlehrerStampacchia1980}, but the stronger condition will apply in our examples.  As in the calculus of variations \cite{Evans2010}, coercivity permits a weak compactness argument for unbounded sets $\cK$.

When $f$ is monotone, VI \eqref{eq:vi} generalizes the problem of minimizing a convex function over $\cK$.  In fact, suppose $F:\cV \to \RR$ is lower semi-continuous and (G\^ateau) differentiable with continuous derivative $F':\cV \to \cV'$.  Then $F$ is convex if and only if $F'$ is monotone \cite[Proposition I.5.5]{EkelandTemam1976}, and if $F$ is convex then \eqref{eq:vi} holds for $f=F'$ and $g=0$ if and only if
\begin{equation}
u = \operatorname{arg-min}_{v\in\cK} F(v) \label{eq:minimization}
\end{equation}
\cite[Proposition II.2.1]{EkelandTemam1976}.  Note that Tai \cite{Tai2003} addresses optimization problem \eqref{eq:minimization}.

However, not all VIs correspond to optimization.  For example, consider the following steady advection-diffusion problem over $H_0^1(\Omega)$.  (We denote Sobolev spaces by $W^{k,p}(\Omega)$ if $k\ge 0$ and $p\ge 1$ \cite{Evans2010}, and $W^{k,2}=H^k$ in particular.)

\begin{example}  \label{ex:advectiondiffusion}  Suppose $\Omega \subset \RR^d$ is bounded and open with polygonal boundary.  Let $\cV = H_0^1(\Omega)$ and consider $\cK = \{v\ge 0\} \subset \cV$.  For $\bX \in L^\infty(\Omega)^d$ such that $\Div \bX=0$, and $u$ in $\cK$ let
\begin{equation}
\ip{f(u)}{v} = \int_\Omega \grad u \cdot \grad v\,dx - (\bX \cdot \grad u) v\,dx. \label{eq:nongradientexample}
\end{equation}
FIXME any $g\in\cV'$; POINT OUT THAT IS STEADY ADVECTION-DIFFUSION VI; MAKE ARGUMENT FOLLOWING \cite{Elmanetal2014}; see also \cite{Kirby2010}; IF $\bX=0$ THEN IT IS OPTIMIZATION BUT OTHERWISE NOT; $2$-coercive if outflow on Neumann; It is easy to see that $|\ip{f(u)}{v}| \le c \|u\|_{\cV} \|v\|_{\cV}$, thus that $f:\cK \to \cV'$ is continuous.
\end{example}

Other examples of VI problems which are not of optimization type are found in ice sheet models \cite{Calvoetal2002,JouvetBueler2012} and other geophysical fluids problems \cite{Bueler2021conservation}.

The VIs solved in this paper satisfy a stronger form of coercivity than \eqref{eq:coercive}.  This stronger assumption will be used in proving convergence of MCD methods.

\begin{definition}  Let $p>1$.  The map $f:\cK \to \cV'$ is \emph{$p$-coercive} if there exists $\kappa>0$ such that
\begin{equation}
\ip{f(u)-f(v)}{u-v} \ge \kappa \|u-v\|^p \qquad \text{for all } u,v \in \cK. \label{eq:pcoercive}
\end{equation}
(Note \cite{Tai2003} uses ``coercive'' for $2$-coercive.)
\end{definition}

It is easy to see that if $f$ is $p$-coercive then it is monotone, strictly monotone, and coercive, and thus the following result, which states that the VI problems considered in this paper are well-posed, is immediate.

\begin{theorem}  \label{thm:viwellposed}  If $f:\cK \to \cV'$ is continuous and $p$-coercive (for $p>1$) then there exists a unique $u\in \cK$ so that VI \eqref{eq:vi} holds.
\end{theorem}

Our multilevel algorithms (next section) are based on both subspace and constraint decompositions, as follows.  Suppose there are $m<\infty$ subspaces $\cV_i \subset \cV$ so that
\begin{equation}
\cV = \sum_{i=1}^m \cV_i \label{eq:subspacedecomp}
\end{equation}
holds in the sense that if $w \in \cV$ then there exist $w_i \in \cV_i$ so that $w = \sum_i w_i$ \cite{Xu1992}.  Suppose further that $\cK_i \subset \cV$ are nonempty, closed, and convex subsets such that
\begin{equation}
\cK_i \subset \cV_i \qquad \text{and} \qquad \cK = \sum_{i=1}^m \cK_i. \label{eq:constraintdecomp}
\end{equation}
The constraint decomposition \cite{Tai2003} sum in \eqref{eq:constraintdecomp} is required to hold in two senses: \emph{(i)}~if $w \in \cK$ then there exist $w_i \in \cK_i$ so that $w = \sum_i w_i$, and \emph{(ii)}~if $z_i \in \cK_i$ for each $i$ then $\sum_i z_i \in \cK$.  (The latter sense is automatic in \eqref{eq:subspacedecomp} because $\cV_i$ are subspaces.)  Note that neither decomposition is unique (in general), and that $\cK_i \not\subset \cK$ in many applications.

Following \cite{Tai2003}, for each $\cK_i$ we also assume a (generally) nonlinear restriction operator $R_i : \cK \to \cK_i$ such that
\begin{equation}
v = \sum_{i=1}^m R_i v \qquad \text{if } v \in \cK.  \label{eq:constraintrestrictionsum}
\end{equation}
An \emph{constraint decomposition} of the constraint set $\cK$ is a choice of $\cV_i,\cK_i,R_i$ satisfying the above hypotheses.

In the next section we will introduce FE spaces and describe practical algorithms, but, as noted in the Introduction, constraint decompositions may be defined at the level of the continuum problem.  The following examples illustrate constraint decompositions of \emph{obstacle problems} \cite{GraeserKornhuber2009}; Example \ref{ex:domaindecomposition} is an overlapping domain decomposition and \ref{ex:frequencydecomposition} is a nonoverlapping frequency decomposition.  The latter example can be compared to the multilevel FE decomposition in the next section.

\begin{example}  \label{ex:domaindecomposition}  Consider a bounded domain $\Omega \subset \RR^d$ with polygonal boundary, let $\cV = H_0^k(\Omega)$, $k\ge 1$, and suppose the obstacle $\psi \in H^k(\Omega)$ satisfies $\psi|_{\partial \Omega} \le 0$.  Let $\cK = \{v \ge \psi\} \subset \cV$.  Suppose further that $\{\phi_i\}_{i=1}^m$ is a smooth partition of unity on $\Omega$, i.e.~so that $0 \le \phi_i\le 1$ and $\sum_i \phi_i = 1$, and let $\Omega_i = \supp \phi_i$ (open support).  Let $\cV_i = \{w \in \cV:w|_{\Omega \setminus \Omega_i} =0 \}$, $\cK_i = \{v \in V: v \ge \phi_i \psi\}$, and $R_i(v) = \max\{v,\phi_i \psi\}$.  Then \eqref{eq:subspacedecomp}, \eqref{eq:constraintdecomp}, and \eqref{eq:constraintrestrictionsum} all hold.
\end{example}

\begin{example}  \label{ex:frequencydecomposition}  For simplicity suppose $\Omega = (0,a)^d \subset \RR^d$ for $a>0$, a cube, and let $\cV = H_{\text{per}}^k(\Omega)$, $k\ge 1$, be the periodic functions.  Suppose $\psi \in H^k(\Omega)$ and let $\cK = \{v \ge \psi\} \subset \cV$.  Without getting into any detailed notation of frequency representation, but noting that the frequencies are discrete, suppose $\cV_i \subset \cV$ are $m<\infty$ subspaces from an (nonoverlapping) partition by frequency, thus satisfying \eqref{eq:subspacedecomp}.  Suppose $P_i:\cV \to \cV_i$ are the corresponding orthogonal projections, satisfying $I = \sum_i P_i$.  Let $\cK_i = \{v \ge P_i \psi\} \subset \cV$ and $R_i(v) = \max\{v,P_i \psi\}$.  Then \eqref{eq:constraintdecomp} and \eqref{eq:constraintrestrictionsum} hold.
\end{example}

In Example \ref{ex:domaindecomposition}, note that $\cK_i \not\subset \cK$ in many cases, for example if $\psi$ is positive over portions of $\Omega$ where the decomposition into overlapping subdomains $\Omega_i$ is nontrivial.  A similar comment applies in Example \ref{ex:frequencydecomposition}.


FIXME state the basic ``sequential constraint decomposition'' and ``parallel constraint decomposition'' algorithms

In practice the space $\cV$ will be a finite-dimensional finite element (FE) space because we will solve VI \eqref{eq:vi} over a mesh.  We FIXME triangulation etc. Though our 

\begin{example}  FIXME $\cV_i$ are 1d spaces on a single level; $\psi,\cK,\cK_i$ for obstacle problem; note $\cK_i \not\subset \cK$ when $\psi>0$
\end{example}


\section{Multilevel constraint decomposition algorithms} \label{sec:multilevel}

FIXME state essentially Algorithm 4.7 \cite{GraeserKornhuber2009} but with $\text{V}(\nu_1,\nu_2)$ cycles which works for linear; observe that up-smoothing is more efficient; state the FAS version which has $O(m)$ residual evaluation complexity on each level


\section{Convergence of the basic algorithm} \label{sec:convergence}

FIXME


\section{Results} \label{sec:results}

FIXME


\small

\bigskip
\bibliography{mcd2}
\bibliographystyle{siam}

\end{document}
